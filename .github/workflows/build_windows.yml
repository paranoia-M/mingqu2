name: Build Windows Exe

on:
  push:
    tags:
      - 'v*'

jobs:
  build:
    runs-on: windows-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4  # ğŸ‘ˆ å‡çº§åˆ° v4

    - name: Set up Python
      uses: actions/setup-python@v5  # ğŸ‘ˆ å‡çº§åˆ° v5
      with:
        python-version: '3.10' 

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        pip install pyinstaller

    - name: Build EXE
      run: |
        # --noconsole: ä¸æ˜¾ç¤ºé»‘è‰²å‘½ä»¤è¡Œçª—å£
        # --onefile: æ‰“åŒ…æˆå•ä¸ªexeæ–‡ä»¶
        # --add-data: æŠŠ assets æ–‡ä»¶å¤¹æ‰“åŒ…è¿›å» (Windowsä¸‹åˆ†éš”ç¬¦æ˜¯ ;)
        # --name: ç”Ÿæˆçš„æ–‡ä»¶å
        pyinstaller --noconsole --onefile --name="SmartCanalMonitor" --add-data "assets;assets" main.py

    - name: Upload Artifact
      uses: actions/upload-artifact@v4  # ğŸ‘ˆ è¿™é‡Œå¿…é¡»å‡çº§åˆ° v4ï¼Œè§£å†³äº†ä½ çš„æŠ¥é”™
      with:
        name: SmartCanalMonitor-Windows
        path: dist/SmartCanalMonitor.exe
        # v4 ç‰ˆæœ¬é»˜è®¤ä¼šè‡ªåŠ¨å‹ç¼©ï¼Œæ‰€ä»¥ä½ ä¸‹è½½åˆ°çš„ä¼šæ˜¯ä¸€ä¸ª zip åŒ…